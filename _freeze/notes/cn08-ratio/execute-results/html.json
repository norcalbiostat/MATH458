{
  "hash": "d57eea0bca7756dedebb9ffe76dc82b5",
  "result": {
    "markdown": "---\ntitle: \"Ratio and Regression Estimation\"\ndescription: \"\"\nauthor: Dr. D\ndate: 5/30/23\nexecute: \n  warning: false\n  message: false\n---\n\n\n# Introduction\n\n:::{.callout-tip icon=true}\n### Motivating Example: Estimating number of people living in France in 1802\n\nIn the 1800's, France did not have a population census count. So some fancy mathematician by the name of Laplace decided he was going to figure it out using sampling and some ideas behind measure of association. \n\nHe sampled 30 communities throughout the country, totaling 2,037,615 people. \n\nHe reasoned that communities with large populations are also likely to have a large number of registered births. So he looked back in the prior 3 years and counted the number of live births in those communities, finding it to be 215,599. Dividing that number by 3, he calculated this was about 71,866.33 births per year. \n\nHe then divided the total number of people, by the number of births pear year, $\\frac{2037615}{71866.33} = 28.352845$, as an estimate of the number of people alive for each new birth. \n\nAssuming this ratio is similar throughout France, he concluded that the total population of France could be estimated by multiplying the total number of annual births in the country by that ratio $28.352845$. \n\nLaplace was not interested in the number of births on it's own, but used it as _auxilary information_ to estimate the desired quantity of total population.\n:::\n\n## Using Auxilary information\n\nSometimes due to difficulty or cost of data collection, researchers may collect data on secondary measures that are known to be associated with the measure of interest, then leverage that association to improve the precision of the estimators. \n\nTwo methods to do this are called **Ratio** and **Regression** estimation. \n\n# Ratio Estimation in SRS\n\nLet $y_{i}$ be the measure of interest, and $x_{i}$ be the auxiliary/secondary/subsidiary variable. Both measurements **MUST** be taken on the same sample unit $i$. \n\nThen in a population of size $N$ the totals for each measure are\n\n$$\nt_{y} = \\sum_{i=1}^Ny_{i} \\qquad t_{x} = \\sum_{i=1}^Nx_{i}\n$$\n\nand their ratio is calculated as\n$$\nB = \\frac{t_{y}}{t_{x}} = \\frac{\\mu_{y}}{\\mu_{x}}.\n$$\n\n\n:::{.callout-tip icon=true}\n### Example: Farm yield\n\nSuppose the population consists of agricultural fields of different sizes. Let\n\n* $y_{i}$ = bushels of grain harvested in field $i$\n* $x_{i}$ = acreage of field $i$. \n:::\n\nThen \n\n* $B$ = average yield in bushels per acre\n* $\\mu_{y}$ = average yield in bushels per field\n* $t_{y}$ = total yield in bushels\n\nIf we take an SRS, we can then calculate the ratio estimates for these values using\n\n* $\\hat{B} = \\frac{\\bar{y}}{\\bar{x}} =  \\frac{\\hat{t}_y}{\\hat{t}_x}$\n* $\\hat{\\bar{y}_r} = \\hat{B}\\mu_x$\n* $\\hat{t}_{yr} = \\hat{B}t_x$\n\n:::{.callout-note}\n### :question: Why $B$?\n\nThe equation $y = Bx$ is a linear equation line, with $B$ as the slope!\n:::\n\n## Why use Ratio Estimation\n\n:::{.callout-note appearance=minimal}\n### :question: :busts_in_silhouette: Class Contributions\nClass write up this section.\n:::\n\n\n\n\n:::{.callout-tip icon=true}\n### Example: Total acreage of farms in 1992, based on data from '87. \n\n[Pretend it's 1992](https://www.youtube.com/watch?v=zDKO6XYXioc) and since we did a census of farmland in 1987 we the true population values. But that was super expensive so we want to find a better way for this year. \n \nIn 1987 a total of $t_x$ = 964,470,625 acres were devoted to farms across the 3,078 counties in the US, with average acres per county $\\mu_x$ = 313,343.3. Use these values along with data taken from an SRS (`agsrs.csv`) to estimate the total and average number acres devoted to farmland in 1992. \n\n\na. Calculate the correlation coefficient, and create a scatterplot of `acres87` against `acres92` first to assess the linear correlation between these two measures and to comment on if it's even reasonable to use 1987 values to estimate 1992 amounts. \n\nb. Use the population values from 1987 along with the data in the variable `acres92` to calculate $\\hat{B}, \\hat{\\bar{y}}_r$, and $\\hat{t}_{yr}$ for 1992. \n\nc. Compare $\\hat{t}_{yr}$ to $\\hat{t}_{srs}$ for 1992. \n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nagsrs <- read_csv(here::here(\"data/agsrs.csv\"))\n```\n:::\n\n\na. Visualize the relationship between acres in 1987 and 1992 on the SRS of $n=300$. It is important to use both a linear model straight line, and the lowess smoother line to assess how well a linear model may fit this relationship. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(agsrs, aes(x=acres87, y=acres92)) + geom_point() + \n  geom_smooth(method=\"lm\", col=\"red\", se=FALSE) + \n  geom_smooth(col=\"blue\", se=FALSE) + theme_minimal()\n```\n\n::: {.cell-output-display}\n![](cn08-ratio_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=480}\n:::\n\n```{.r .cell-code}\ncor(agsrs$acres87, agsrs$acres92)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.995806\n```\n:::\n:::\n\n\nThe blue and red lines are nearly overlapping, and the correlation coefficient is incredibly high at 0.996. A linear model fits this relationship well, and so the ratio estimate is reasonable to use. \n\nb. Calculate estimated ratio and estimators for average and total acrage. \n\n**Estimated Ratio** $\\hat{B} = \\frac{\\bar{y}}{\\bar{x}}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx.bar <- mean(agsrs$acres87) \ny.bar <- mean(agsrs$acres92) \n(B.hat = y.bar/x.bar)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9865652\n```\n:::\n:::\n\n\n**Ratio Estimator for $\\hat{\\bar{y}}_r = \\hat{B}\\mu_x$**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB.hat * 313343.3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 309133.6\n```\n:::\n:::\n\n\n**Ratio Estimator for $\\hat{t}_{yr} = \\hat{B}t_x$**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nB.hat * 964470625\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 951513191\n```\n:::\n:::\n\n\nc. Compare the ratio estimator of the total to the estimate obtained under SRS\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny.bar*3078\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 916927110\n```\n:::\n:::\n\n\nIn this case, the ratio estimator is smaller than the estimate obtained from the SRS directly. Let's see why this may be the case. \n\n\n![Textbook Figure 4.2. Detail of the center portion of the plot of acreage, 1992 vs 1987 from a SRS of 300 counties.](../figs/fig4_2.jpg)\n\n* We notice that $\\bar{x} \\lt \\mu_x$, so our SRS underestimates the true population mean from 1987. \n* Since $x$ and $y$ are positively correlated, it is reasonable to expect that $\\bar{y}$ will similarily underestimate $\\mu_y$\n* However, the ratio estimator $\\hat{\\bar{y}}_r$ gives a more precise estimate of $\\mu_y$ because $\\bar{y}$ is multiplied by the factor $\\frac{\\mu}{\\bar{x}}$, which corrects for that underestimation. \n\n\n:::{.callout-warning icon=false}\n### :star: You try it\nWhat if we didn't have data from 1987? Could we use data from 1982? Use the correlation coefficient and a plot to justify your answer. \n:::\n\n\n\n",
    "supporting": [
      "cn08-ratio_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}