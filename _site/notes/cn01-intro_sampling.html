<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="COMPLETE">
<meta name="dcterms.date" content="2025-01-22">
<meta name="description" content="The objective of sample surveys is to make inference about a population from information contained in a sample selected from that population.">

<title>Sampling Methods - The Sampling Framework</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Sampling Methods</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project.html"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hackmd-notes" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">HackMD Notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hackmd-notes">    
        <li>
    <a class="dropdown-item" href="https://hackmd.io/@norcalbiostat/458_intro_hackmd">
 <span class="dropdown-text">What is HackMD</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hackmd.io/@norcalbiostat/cn01-intro_sampling">
 <span class="dropdown-text">Ch 1. Sampling Framework</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hackmd.io/@norcalbiostat/cn02-statistical_foundations">
 <span class="dropdown-text">Ch 2. Foundations of Estimation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hackmd.io/@norcalbiostat/cn04_stratified">
 <span class="dropdown-text">Ch 3. Stratified Sampling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://hackmd.io/@norcalbiostat/cn05_cluster">
 <span class="dropdown-text">Cluster Sampling</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-google" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-google" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-google">    
        <li>
    <a class="dropdown-item" href="https://docs.google.com/spreadsheets/d/1Inj6xmMsoRcIHR5mpVShQisg5llXwesoDRuVRbvI5mY">
 <span class="dropdown-text">Content creation group</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/spreadsheets/d/1f4ze0905zE4HbtEyqVrJv1ncMB4EdNZDd4QJH5wewS0">
 <span class="dropdown-text">Sechedule</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://drive.google.com/drive/folders/13YG6_6exekRfJr2NngUCO465UosodQGA">
 <span class="dropdown-text">Project folder</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../formulas.html"> 
<span class="menu-text">Formulas and Definitions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#populations-and-representative-samples" id="toc-populations-and-representative-samples" class="nav-link" data-scroll-target="#populations-and-representative-samples">(1.2) Populations and Representative Samples</a>
  <ul class="collapse">
  <li><a href="#key-terms" id="toc-key-terms" class="nav-link" data-scroll-target="#key-terms">Key Terms</a></li>
  </ul></li>
  <li><a href="#selection-bias" id="toc-selection-bias" class="nav-link" data-scroll-target="#selection-bias">(1.3) Selection Bias</a>
  <ul class="collapse">
  <li><a href="#what-good-are-samples-with-selection-bias" id="toc-what-good-are-samples-with-selection-bias" class="nav-link" data-scroll-target="#what-good-are-samples-with-selection-bias">What Good Are Samples with Selection Bias?</a></li>
  </ul></li>
  <li><a href="#measurement-error" id="toc-measurement-error" class="nav-link" data-scroll-target="#measurement-error">(1.4) Measurement Error</a>
  <ul class="collapse">
  <li><a href="#surveying-people" id="toc-surveying-people" class="nav-link" data-scroll-target="#surveying-people">Surveying people</a></li>
  </ul></li>
  <li><a href="#questionnaire-design" id="toc-questionnaire-design" class="nav-link" data-scroll-target="#questionnaire-design">(1.5) Questionnaire Design</a>
  <ul class="collapse">
  <li><a href="#guidance" id="toc-guidance" class="nav-link" data-scroll-target="#guidance">Guidance</a></li>
  </ul></li>
  <li><a href="#sampling-and-nonsampling-errors" id="toc-sampling-and-nonsampling-errors" class="nav-link" data-scroll-target="#sampling-and-nonsampling-errors">(1.6) Sampling and Nonsampling errors</a></li>
  <li><a href="#why-use-sampling" id="toc-why-use-sampling" class="nav-link" data-scroll-target="#why-use-sampling">(1.7) Why use sampling?</a>
  <ul class="collapse">
  <li><a href="#advantages-of-a-sample-instead-of-a-census" id="toc-advantages-of-a-sample-instead-of-a-census" class="nav-link" data-scroll-target="#advantages-of-a-sample-instead-of-a-census">Advantages of a sample instead of a census</a></li>
  </ul></li>
  <li><a href="#types-of-probability-sampling" id="toc-types-of-probability-sampling" class="nav-link" data-scroll-target="#types-of-probability-sampling">(2.1) Types of Probability Sampling</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Sampling Framework</h1>
</div>

<div>
  <div class="description">
    The objective of sample surveys is to make inference about a population from information contained in a sample selected from that population.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>COMPLETE </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The objective of sample surveys is to make inference about a population from information contained in a sample selected from that population. We are usually interested in estimating some population parameter such as the population mean, proportion or total.</p>
</section>
<section id="populations-and-representative-samples" class="level1">
<h1>(1.2) Populations and Representative Samples</h1>
<p>A sample is representative if it can be used to “reconstruct” what the population looks like and if we can provide an accurate assessment of how good that reconstruction is.</p>
<section id="key-terms" class="level2">
<h2 class="anchored" data-anchor-id="key-terms">Key Terms</h2>
<p>Some definitions are needed to make the notions of a “population” and a “representative sample” more precise.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/fig1_1.png" class="img-fluid figure-img"></p>
<figcaption>Textbook Figure 1.1. Target population and sampled population in a telephone survey of registered voters.</figcaption>
</figure>
</div>
<ul>
<li><strong>Observational Unit</strong>: The singular object that is being measured. A <span class="emoji" data-emoji="cat2">🐈</span>.</li>
<li><strong>Target Population</strong>: The complete collection of all observational units that we want to study. All <span class="emoji" data-emoji="cat2">🐈</span> in Chico.</li>
<li><strong>Sample</strong>: A subset of the population. The <span class="emoji" data-emoji="cat2">🐈</span> at Butte Humane Society</li>
<li><strong>Sampled population</strong>: The collection of all possible observational units that <em>might</em> have been chosen in a sample. Adoptable <span class="emoji" data-emoji="cat2">🐈</span><span class="emoji" data-emoji="cat2">🐈</span> in Chico.</li>
<li><strong>Sampling unit</strong>: A observational unit that can be selected for study. A <span class="emoji" data-emoji="cat2">🐈</span> available for adoption at BHS.</li>
<li><strong>Sampling frame</strong>: A list, map, or other specification that describes how sampling units from the sample may be selected. The roster of <span class="emoji" data-emoji="cat2">🐈</span><span class="emoji" data-emoji="cat2">🐈</span> listed for adoption at BHS.</li>
</ul>
<p>In an <em>ideal</em> survey, the sampled population will be identical to the target population. 🦄</p>
<section id="other-examples" class="level4">
<h4 class="anchored" data-anchor-id="other-examples">Other examples</h4>
<p><strong>American Community Survey</strong></p>
<ul>
<li><strong>Target Population</strong>: Resident Population of the US</li>
<li><strong>Sampling frame</strong>: residental housing units and group quarters</li>
<li><strong>Observational Unit</strong>: Household<br>
</li>
<li><strong>Sample</strong>: 3.5 million housing addresses</li>
<li><strong>Sampled population</strong>: person who lives at one place on the list and will participate in survey</li>
<li><strong>Sampling unit</strong>: household on the list</li>
</ul>
<p><strong>Agricultural survey</strong></p>
<ul>
<li><strong>Target Population</strong>: All areas of land used for agriculture in a country</li>
<li><strong>Sampling frame</strong>: Random selections from a list of all the areas</li>
<li><strong>Observational Unit</strong>: farm operator</li>
<li><strong>Sample</strong>: Random areas of land</li>
<li><strong>Sampled population</strong>: The list of land in the country</li>
<li><strong>Sampling unit</strong>: Smaller sections of owned land</li>
</ul>
<p><strong>Literary Digest Election survey</strong></p>
<ul>
<li><strong>Target Population</strong>: All people who would vote on election day</li>
<li><strong>Sampling frame</strong>: Voter registration datasets</li>
<li><strong>Observational Unit</strong>: A single voter</li>
<li><strong>Sample</strong>: people who read literary digest</li>
<li><strong>Sampled population</strong>: persons on the lists used by the Literary Digest who would return the sample ballot.</li>
<li><strong>Sampling unit</strong>: A single respondent</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="selection-bias" class="level1">
<h1>(1.3) Selection Bias</h1>
<p><strong>Selection bias</strong> occurs when the target population does not coincide with the sampled population because some population units are sampled at a different rate than intended by the investigator.</p>
<p><span class="emoji" data-emoji="question">❓</span> If a survey designed to study household income has fewer poor households than would be obtained in a representative sample, would the survey estimates of the average or median household income be too high? or to low?</p>
<blockquote class="blockquote">
<p>Too high.</p>
</blockquote>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="emoji" data-emoji="question">❓</span> <span class="emoji" data-emoji="busts_in_silhouette">👥</span> Some types of selection bias
</div>
</div>
<div class="callout-body-container callout-body">
<p>Summarize briefly and provide a unique example (that is, not the one in the text) for the type of selection bias that you are assigned to review. Be prepared to share this out with the class.</p>
</div>
</div>
<ul>
<li><strong>Convenience Sample</strong>: Choosing a sample which is not representative of the target population due to difficulties collecting certain portions/groups of the population response. Example: If I only surveyed everyone in this room to get information about people living in the United States since it’s more convenient, it wouldn’t be representative of all people in the United States.</li>
<li><strong>Purposive or Judgement Sample</strong>: Choosing a sample that would favor in our experiment. An example would be choosing a race against crime rates.</li>
<li><strong>Self-Selected Sample</strong>: The participants of a sample opt in voluntarily to participate. Not representative of larger population. People can sometimes respond more than once skewing the data. Example: Users of a specific website agree to take a survey.</li>
<li><strong>Undercoverage Bias</strong>: The inability to achieve a representative sample because members of the population can not be reached for a variety of reasons (ex. phone surveys cant reach people without phones. Email surveys cant reach people without email addresses…).</li>
<li><strong>Overcoverage</strong>: When observational units that are not part of the target population are included in the sample, this is <em>overcoverage</em>. In plain language, it’s when units that shouldn’t be surveyed are surveyed. This can occur when your sampling frame is too big, so you need to weed-out units that don’t belong in the sample. Units might be double-counted (like a house with two phone numbers getting called twice, or when ecologists both count the same bird).</li>
<li><strong>Nonresponse</strong>: Failing to get responses from the sample, without external sources as to why. EX(Fewer than 1% households agree to participate in a poll.)</li>
</ul>
<section id="what-good-are-samples-with-selection-bias" class="level3">
<h3 class="anchored" data-anchor-id="what-good-are-samples-with-selection-bias">What Good Are Samples with Selection Bias?</h3>
<p>Can Bias ever be good? Yes! It may provide valuable information, especially in early stages of investigation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example: Early indicators of lung injury associated with vaping (2019)
</div>
</div>
<div class="callout-body-container callout-body">
<p>By Oct ’19, over 1,600 cases of lung injuries and 34 deaths were found to be associated with vaping, but the actual cause of injuries were not known. In 2019 a group of researchers (see text for citation) conducted a study that ultimately led to the recommendation that the public stop using these products until more research on the causal association could be conducted.</p>
<p>This impact survey had the following types of selection bias:</p>
<ul>
<li>Researchers attempted to interview 83 patients who were reported to have lung injuries but only 53 responded (non-response bias).</li>
<li>The sampling frame of 83 only came from physician-reported cases, which means there may be bias if the physicians only reported the more serious cases (undercoverage)</li>
<li>THC is illegal in that state, so patients may have under-reported their use (undercoverage)</li>
<li>Individuals who vape, incurred a lung injury but didn’t seek care were excluded from the study (undercoverage)</li>
</ul>
</div>
</div>
<p>Just because your sample may likely contain bias, being up front about it in your reporting (this is what the limitations section is all about) is a very important aspect of open science.</p>
<hr>
</section>
</section>
<section id="measurement-error" class="level1">
<h1>(1.4) Measurement Error</h1>
<ul>
<li><strong>Measurement error</strong>: When the response differs from the true value</li>
<li><strong>Measurement bias</strong>: When the error tends to only occur in one direction</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example: Ecology surveys
</div>
</div>
<div class="callout-body-container callout-body">
<p>Often in ecological surveys, areas are divided into plots or grids of smaller size. A sample of plots/grids are selected and the number of plants in those selected grids are counted.</p>
<p>Field researchers have to make a decision about whether or not to count plants directly on the border. If one researcher always counts plants on the boarder as being inside the grid, and another one does not, their estimate will always be higher than the other person.</p>
</div>
</div>
<section id="surveying-people" class="level2">
<h2 class="anchored" data-anchor-id="surveying-people">Surveying people</h2>
<p>Obtaining accurate responses is challenging in all types of surveys. Especially when dealing with humans.</p>
<p><span class="margin-aside">Bonus credz to anyone who can name this bat. Double credz if you can quote a line from his intro rap.</span> <img src="../figs/batty.gif" class="img-fluid" alt="Sourced from Tenor.com"></p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="emoji" data-emoji="question">❓</span> <span class="emoji" data-emoji="busts_in_silhouette">👥</span> Think-pair-share
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write down <em>all</em> reasons you can think of for measurement error in self-report surveys on people. Write down everything that comes to mind, no judgement on if you think its a “good” response or not.</p>
</div>
</div>
<ul>
<li>People may choose not to respond or lie if they’re embarrassed about the response (like income level)</li>
<li>People may misunderstand the question</li>
<li>People may not remember the information correctly</li>
<li>People may have incorrect information influencing their response. For example, people may not actually know their ethnic background, only what their parents have told them.</li>
<li>People might just lie for fun, like putting that they’re a 100 year old bazillionaire in a questionnaire.</li>
<li>May accidentally respond to the wrong question (online survey)</li>
<li>people may not care about the survey or forced to do it so speed through it</li>
<li>May misunderstand the question</li>
<li>May try to sound good (e.g.&nbsp;how much they donate or would donate to a cause)</li>
<li>May over estimate own capabilities</li>
<li>They don’t like the interviewer</li>
<li>The question is too loaded</li>
<li>People from different cultures may have different definitions of categorical responses. (Eg. “Very good” may have a different meaning among Italians vs.&nbsp;Americans)</li>
<li>People may have a language barrier that makes it hard for people to answer</li>
<li>They might feel unsecure disclosing certain information.</li>
<li>if someone has done something illegal and fears repurcusions.</li>
<li>does not want answers traced back to themselves</li>
<li>Genuinely just dumb (taking a survey they know nothing about)</li>
<li>Not being self-aware (being asked questions about self, thinks too highly or too lowly)</li>
<li>overexaggerate a ‘positive’ thing and understate to a negative</li>
<li>Self incrimination</li>
</ul>
<p>Clear sampling protocols and thoughtful &amp; validated survey design can minimize measurement error.</p>
<hr>
</section>
</section>
<section id="questionnaire-design" class="level1">
<h1>(1.5) Questionnaire Design</h1>
<p>This is a short, short version of how to design a questionnaire. If you are considering writing one for a project or thesis, please consult one of the references at the end of the chapter in the textbook.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The most important step
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is deciding what you want to learn. What are the goals of your survey?</p>
</div>
</div>
<p>Be as precise as possible</p>
<blockquote class="blockquote">
<p>“I want to learn something about persons experiencing homelessness”</p>
</blockquote>
<p>Is not good enough. Let’s revise this to</p>
<blockquote class="blockquote">
<p>“What percentage of persons using homeless shelters in Chicago between January and March 2021 are under 16 years old?”</p>
</blockquote>
<p>Now you can write questions that will be able to actually answer this research question.</p>
<section id="guidance" class="level2">
<h2 class="anchored" data-anchor-id="guidance">Guidance</h2>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="emoji" data-emoji="question">❓</span> <span class="emoji" data-emoji="busts_in_silhouette">👥</span> Think-pair-share
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use HackMD to summarize the guidance item assigned to you. Be prepared to share out verbally in class.</p>
</div>
</div>
<ul>
<li>Test the questions before administering the survey.
<ul>
<li>Before you follow through with the survey, you should test the questions in a smaller sample within the target population to ensure that there is no misintepretation on the questions.</li>
<li>In other words, test your questions(for clarity) on a very small sample before conducting a mass scale survey.</li>
</ul></li>
<li>Keep it simple and clear
<ul>
<li>The idea is the simpler question is easy to give an accurate answer.</li>
<li>Keep language at a comprehendable level to your audience</li>
<li>Try to get an answer for one variable/parameter at a time per question</li>
</ul></li>
<li>Define your terms - Be as specific as possible in your language. When there is ambiguity be explicit in what you are asking. Words mean different things to different people; be clear about your meaning. Ex. is a truck a car?</li>
<li>Relate your questions to the concept of interest.
<ul>
<li>Ensure questions are directly correlating to what we want to learn, some surveys created mislead information due to the questions being too broad or too specific Example: Testing for income levels and including a question about depression</li>
</ul></li>
<li>Decide whether to use open or closed questions
<ul>
<li>Using open and closed questions each have their advantages and disadvantages. If you use open questions, the respondent can choose any answer that they feel is appropriate, but there might be some things that don’t come to mind. If you use closed questions, you can give the respondent a few ideas that they might forget about, but they might feel limited to just those options.</li>
</ul></li>
<li>Pay attention to response option scales - People tend to prefer responding when there is a neutral middle option to use as a reference for describing their opinions. ex: people prefer a five point scale to a six point. What “fairly happy” means is dependent on what the other options are, ie number of options worse or better than that option.</li>
<li>Avoid questions that prompt or motivate the respondent to answer in a particular way. Avoid “loaded” questions which try to influence the respondent by using very positive or negative words.
<ul>
<li>Eg. “Would you rather increase funding for the music program (like any good community member would), or shut down the school altogether?”</li>
</ul></li>
<li>Consider the social desirability of responses to questions, and write questions and use modes that elicit accurate responses. People are more likely to over-report positive activities and under-report negative activities.
<ul>
<li>Eg. Respondents underreporting cigarette use to the question “how many packs do you smoke in a week?”</li>
<li>Eg. “How much money loss to stop gambling in one session?”</li>
</ul></li>
<li>(Don’t not) avoid double negatives; they’re needlessly confusing and might cause the respondent to answer in the exact opposite way they intend.
<ul>
<li>Example from the book: “Do you favor or oppose not allowing drivers to use their cell phones while driving?” The double negative is “do you oppose not allowing…” This could be written as “Do you support or oppose a ban on cellphone use while driving” to alleviate the needless confusion.<br>
</li>
<li>Instead of “do you oppose not drilling for oil” should be asked as “do you support drilling for oil?”</li>
<li>Another example, not from the book that would be considered confusing is “do you not disagree with this question?”</li>
</ul></li>
<li>Use forced-choice rather than agree/disagree questions
<ul>
<li>People answer differently if it’s a yes/no versus a multiple forced-choice option</li>
<li>Examples from the book include: “Do you agree or disagree with this statement ‘most men are better suited emotionally for politics than are most women’” or “Would you say that most men are better suited emotionally for politics than are most women, that men and women are equally suited, or that women are better suited than men in this area”
<ul>
<li>Interpretation: What they found was that if it was a yes or no, people tend to lean toward yes if they had less schooling meanwhile if you are given options, a portion of the men that originally said “yes” were now spread across education levels</li>
</ul></li>
</ul></li>
<li>Ask only one concept per question
<ul>
<li>Keep the questions as simple and straight forward. With two questions someone might agree with one but disagree with the other. The data is then wrong when two questions should of been asked.</li>
<li>Example: Did you vote for Obama and should healthcare be free.</li>
</ul></li>
<li>Pay attention to question order effects.
<ul>
<li>Question and answer may affect response to following questions</li>
<li>Emotionally loaded question may affect following question towards a bias</li>
<li>Try to ask questions that may be emotionally disconnected from each other</li>
<li>Government spending vs government control</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="sampling-and-nonsampling-errors" class="level1">
<h1>(1.6) Sampling and Nonsampling errors</h1>
<ul>
<li>Most surveys report a “margin of error”, often something like “3 percentage points”</li>
<li>The <strong>margin of error</strong> describes the <strong>sampling error</strong> - that is the error that occurs from taking one random sample instead of measuring the entire population.</li>
<li><strong>Nonsampling errors</strong> cannot be attributed to the sampling variability, but due to selection bias and measurement error.</li>
</ul>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="emoji" data-emoji="star">⭐</span> You try it
</div>
</div>
<div class="callout-body-container callout-body">
<p>Go find a poll on a subject that interests you. Share the following information in the <code>#458-class-chat</code> discord channel, and include this info in your notes.</p>
<ul>
<li><strong>Name of poll</strong>:</li>
<li><strong>URL</strong>:</li>
<li><strong>Stated Population</strong>:</li>
<li><strong>Statistic being estimated</strong></li>
<li><strong>Margin of Error</strong>:</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="why-use-sampling" class="level1">
<h1>(1.7) Why use sampling?</h1>
<blockquote class="blockquote">
<p>“After all, my opinion has never been asked, so how can the survey results claim to represent me?” “Extrapolating what tens of millions are thinking from a tiny sample of opinions affronts human intelligence and negates true freedom of thought.”</p>
</blockquote>
<p>Public distrust of surveys intensify when high stakes elections (1936, 2016) are predicted incorrectly.</p>
<p>Initial recommendations to use a sample to understand a characteristic about a population developed in Norway in 1895, but it wasn’t until 1920-1960 that statisticians were able to create mathematical proofs to support that a <code>probability sample</code> - a sample chosen using random selection methods - produces reliable results that can be used to make inference on a population.</p>
<section id="advantages-of-a-sample-instead-of-a-census" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-a-sample-instead-of-a-census">Advantages of a sample instead of a census</h2>
<ul>
<li>Lower cost</li>
<li>less time consuming</li>
<li>fewer errors?</li>
<li>higher quality of data/ more efficient / reliable information</li>
<li>Predicting trends/coming to conclusions faster(relevance of information after a certain time or time deadline )</li>
<li>Calculable Sampling Error, estimate your uncertainty</li>
<li>Can identify invalid measurements</li>
<li>Higher quality information</li>
<li>It’s easier to manage a sample than a census</li>
<li>Census may cause behavior change in surveyee</li>
</ul>
<blockquote class="blockquote">
<p>“Sampling is not mere substitution of a partial coverage for a total coverage. Sampling is the science and art of controlling and measuring the reliability of useful statistical information through the theory of probability” (Deming, 1950, p.&nbsp;2)</p>
</blockquote>
<hr>
</section>
</section>
<section id="types-of-probability-sampling" class="level1">
<h1>(2.1) Types of Probability Sampling</h1>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition: Probability Sample
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each unit in the population has a known probability of selection, and a random number table or other randomization mechanism is used to choose the specific units to be included in the sample.</p>
<blockquote class="blockquote">
<p>Need a recap on probability? See book Appendix A.1 and A.2</p>
</blockquote>
</div>
</div>
<p>In this class we assume:</p>
<ul>
<li>sampled population is the target population</li>
<li>the sampling frame is complete</li>
<li>that there is no nonresponse or missing data</li>
<li>there is no measurement error</li>
</ul>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simple Random Sample (SRS)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mix up the population before grabbing <span class="math inline">\(n\)</span> units</p>
<p>Examples:</p>
<ul>
<li>Testing blood, already mixed</li>
<li>Taking soil samples from random locations within a land parcel.</li>
<li>Sampling colour ratio of skittles in a bag</li>
</ul>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/srs.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stratified Random Sample
</div>
</div>
<div class="callout-body-container callout-body">
<p>Divide population into strata, then take an SRS from each strata independently. Elements of the same strata are more similar, strata differ from each other on an important characteristic.</p>
<p>Example: Select an area of labled trees that has green and pink trees. split the two different types of trees into two different numbered lists. randomly select a set amount of trees from each list to sample seprately.</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/strat.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cluster sample
</div>
</div>
<div class="callout-body-container callout-body">
<p>Divide population into clusters where clusters are similar to each other. Then measure <em>all</em> units in the cluster.</p>
<p>Select an area of labled trees that has green and pink trees. split the two different types of trees into two different numbered lists. randomly select a set amount of trees from each list to sample seprately.</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/cluster.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Systematic Sample
</div>
</div>
<div class="callout-body-container callout-body">
<p>Start in a random position in list of population members. Then select that unit, and every <span class="math inline">\(k\)</span>th unit thereafter.</p>
<ul>
<li>example 1 Surveying every 10th customer</li>
<li>example 2 Getting mph data from every 4th car</li>
<li>example 3 Testing every 47th can of food for quality</li>
</ul>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../figs/systematic.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sampling-458\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This site is built with <span class="emoji" data-emoji="heart">❤️</span>, <a href="https://posit.co/">R</a> and <a href="https://quarto.org/">Quarto</a> by <a href="www.norcalbiostat.com">Robin Donatello</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>