---
title: "Stratified Sampling"
description: "A method to use additional information about the population in the survey design. Lohr Ch 3. "
author: DRAFT
date: 3/20/23
execute: 
  error: true
  warning: false
  message: false
---

# What is Stratified Sampling 


## Overview

* A sampling technique in which we divide the desired population into subgroups called _strata_
* Each individual is necessarily in a single strata; no overlap within strata
* All strata consist of the entire population
* An SRS is taken from each strata, then results can be pooled to make inferences about the entire population

### Why Use A Stratified Sample?

* Protection from bad samples; less likely of drawing a non representative sample through pure chance
* Want data of known subgroups (i.e.,  if we are interested in people’s heights, we know that men tend to be taller than women)
* Convenience / cost effectiveness 
– At what point will this compromise the legitimacy of the study? 
* Lowers variance when done properly; variance within each strata is likely lower than the population variance
* you do not have to sample the same fraction of observations in each stratum. If the variability is higher in a certain strata then you can try to reduce the variability of the estimated total by taking more observations from that stratum. 
:::{.callout-tip icon=true}

### Motivating Example - Estimating the average number of farm acres.  

```{r}
library(here); library(tidyverse)
agpop <- read_csv(here("data", "agpop.csv"))
```

In Example 2.6  we took a SRS to find the average number of farm acres per county. Even though our methods of taking an SRS were correct, some areas of the country were over or underrepresented due to the variability in the size of farms in different regions in the country. An example of this would be that western states in the U.S tend to be larger, and therefore tend to have larger farms. 

To try and fix this, we can use a stratified sample can give balance to the sample on the stratifying variable, which in this case would be region that the farms are located. 
:::

To begin, we can divide our data into four regions (these are the strata): 

```{r}
unique(agpop$region) # the four regions and their names
```

Previously we sampled 10% of the population with an SRS, and so to be able to compare our results with our stratified sample, we should sample 10% of the population from each strata through four separate and independent SRS's. 

The process to do this would be to take the four regions, number off the counties that are in the region, calculate what number of counties is 10% of the total number of counties in the region, and select that many numbers from the list of numbered counties. 

> _Details on how to do this in R is covered in a later section. For now we will use the `agstrat` dataset from the book as the stratified sample._ 

```{r}
agstrat <- read_csv(here("data", "agstrat.csv"))
```


:::{.callout-tip icon=true}
### Exploring the distribution of farm acreage by region.

```{r}
#| fig-cap: The thick line for each region is the median of the sample data from that region. The upper and lower horizontal lines of the boxes are the 25th and 75th percentiles. 
#| fig-cap-location: top

boxplot(acres92/10^6 ~ region, data = agstrat,
        xlab = "Region", ylab = "Millions of Acres")

```

The Northeast has the lowest median and the smallest variance. The West has the highest median and the highest mean and variance. The distribution of farm acreage appears to to be positively skewed in each region.

:::



# Theory & Weights (Lohr 3.2, 3.3)


# Drawing stratified samples using R

